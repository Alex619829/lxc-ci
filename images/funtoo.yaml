image:
  distribution: funtoo

source:
  downloader: funtoo-http
  url: http://build.funtoo.org
  keys:
    # 30737D12308C9D0C882FC34B57CB0A121BAECB2E
    - |-
      -----BEGIN PGP PUBLIC KEY BLOCK-----

      mQINBFhMV4wBEADnqf2q2BAZuAWODX1XufDSnYS++m/bDyaLQ5ovgALA4Tq6rZQk
      YtPVEENnZwSZa/IHkXwLhyg9wP1b6cNi+yNg/zgEaFvqs9XlHQlBsLwzmfha4mdD
      qDstx10/jvhtReBWJMpGV8u0Tgf/UNA7IHgVv3539/bFcTQEoIY9LdQ4Kdz5TaoT
      n6IloByevVOKcuyyED6lc1INfC38SuG59bvjDa1/13H7pA8OAq6GG/lHH0aVLYqN
      b+yPG5i4meD2APNoZgXuPTFXDoqthdFsO2PRSNFYuw6pf4PWYVCRIo0zxvcWYoYx
      YRVZHMpkjEDJS2xAb8gOKa0Sx7cJzrwcM7a66FXU/OCNd6eLVjyn130nboIwDbAz
      LVu5wQsLG8q2YyhyomAk/BRKProxbfdWN3FYZhBSIIgsfJvBRvzuw/nGg+5+z8L7
      Kl3M69RrL87AyM2WqekdKYD9gRCEZttjspIOzRwb2UfN3PfKD+7OhIPcLtNQgyOo
      YBc3c+rRXMvswYs8ImPZ6pMV5K3a5KNyrRfdPiU733vRdy9mct2ZvIZz+x39G9Ym
      iso7a7ScaJ8ivX0FdWG5NYux4Czowu8VxvSMP2DhDrZ82Th0uIbVweiN9UCVFFCJ
      UjT28J6J0kMmIWPxxDioCDe98sBvLxhyNIGr9R6ITq4R9aKpVKRxKEY1EQARAQAB
      tDFEYW5pZWwgUm9iYmlucyAobWV0cm86bm9kZSkgPGRyb2JiaW5zQGZ1bnRvby5v
      cmc+iQIcBBABCAAGBQJYTFnzAAoJEJplgwbphujutVIP/1Ouax5Oong8fv6rMQWV
      h88C3cbEhCXdn9YcfwWCnwOKMeJPRn5rXI7lk8CTuqykep1hwGOs1H4soGDPH7nM
      SD6XQUijt4ESP6Yqxc9xO0YMFsrsL5cYP6/T4uWYtQl9Yhb0ozVhYl12zsYbXV6U
      D83wsGk+kQo5F7ANsh0g3VlMMvrmqCykjSSrqSAgL7eHDm2CtbfxmxwkoRub3de7
      k0m0Tz9O3ZUMlmh+Bq2+3/C/lo76YygzKqS/RRFaMrttn2mdRRC2DlfQy0I6YIXj
      eXfXVV+hXl+M4ahdJvi1y/YbGpgtkuedHw/fBDYLXMAkz7qEp/2qm361v9FxPG9F
      uhaZ58jkYSbbmLyy0yFKndai8aDLTPU7Y5ha/q0JFF6pW0XNJb/IupqAzmP6w+ul
      dflNCKk6xW5zTCY/v0jh82QgPz0tyfJkPtjYjns+NXuqPv3l6fm/OGQSrQ7iVWQU
      0t0GzuNnlF5g6y3/2CovjoXSwhKlfnxKtCGMi6L1rzHHcjKY9CJFp+5r6VoUxjHP
      TjmOIsmDaJhUoB6nZ+uABswOB8bebqLUXuhSbOcNKZ2uWmQ7dBujU4LAF1i+biM6
      c4weziJqXYttnEnytOEPcDTrVyuIG9leWQ2KvIbkyw25CYamoKuCu49uCTVnVuu1
      q8xCvoLZzFjIozzXIpI22vOLiQI3BBMBCAAhAhsDAh4BAheABQJYTFhFBQsJCAcD
      BRUKCQgLBRYCAwEAAAoJEJJmxPoR/QD9UnAP/3VamQ25nrtubcNgUIlYmvm64Udp
      yboa+sQGPyxLbNtzKtTQNbrCdaPSHq78Fu+npDm0ZbEH0AL5KM+MVVKszD1Iy0VY
      7dsRjPJRB7NH0J0bP/98Cqp659a8s9wSUKtmhVBFvD8wzJ45GGceXyyV3LuaT6AR
      WNtPqG9SZI++amLaIDq2gsPNb8AUuV2cynIEaxuv2uQJ84+ZCWPaoZTZDcvL2P2O
      ycBKmo5avpLY0bl6jLL+IAIF8NPYyoeF8b7sTxD+Cz9CJHBVOC65Zsij73hcLNfh
      Vkm7t3AUm/qLS8R3GHObwP9ctQh2bTat1JrBWFAtRPuvmZE9otlXNUWT07xyVXi1
      F82Q+NWuBSPfxfbr4M7Z3QemL3jT+zVpCygYE1IL0f8hqSwZuJdlyenVDUpu2Jcv
      XrBCMTs/6hE9f7bV5M1XUhACY1DKMVX3Wxh4xaeXQ+z71XBougchZhNKTe5L+gWe
      IEd6pbCcPKxyuZO+fsAKcuQHCc1gLCgq/LR41I4b+uu4zXTKZ4PmuTqinJeHpBRJ
      nSJI0c7rhTizIp0dS4ArkB70AHb1klSJRSgqd1BBcoD9nXgWbLeHGnoVZyFivXbr
      yIKZRGQ3ozd4o9zfclfL3LO67p+vKnryGxNAU6XXGdSKlPIjiyeKYvYqVp7p6099
      XBWngQzwIhjZu6FRiQI5BBMBCAAjBQJYTFeMAhsDBwsJCAcDAgEGFQgCCQoLBBYC
      AwECHgECF4AACgkQkmbE+hH9AP0Ovw/9Fti8RrZ/u4+nqsD/AdS1lOa/GJ7F5lWA
      GbxgN/Ep3hvZP8SGWNtNUmhEZirQwpF0qW5XyyoSQIjon4k5MebHTjXbgM31Nl5S
      UDwMVXH56kI04+O7ATXnhnGM2JgZkVqspxQ6BPXCU1hbpd9BlPtCbdFeNLJWaUin
      OnqTVJt4wFDw0qjrujLSjn+eCdMGo6Yml5V3IE6KGWCZXoIUZ2urX9j851W8sYlD
      773a+oCTbZHBRL2EaBYRcslG398Dm/jxHcHSfIypOXPIJ4pCkQJvdKWQYYp8SD6A
      mUCK1TndLXfWKGMdL2K2iKJVcVNwbrw7hLP1s0krbMzU8CCS8grtEyJu7N033QAP
      QPButUdank5gjtSKFd/mb9sd3BuxtzmRpi8ukDtjSdQDhI4RhzwyNwbQ9WSTlWAU
      4/gh4Am9u8rCmuOoEelG4gczqHR7Uobp+xbPxZneA97lUQh9ZDhq1M1UEOI3qBGr
      Fozi/srhT9rgZYLzk77WEd1HV8A67JCrlbw0n2CfxWcAI1uBQFzK0aOdSptmYFd6
      sYxTztOXeO0olUngptINUOpFgfiRC3iMTUYuUWOzysjAx2I9v9v/fsf7VfeB7P9b
      bIBRX6p+yYPOWP5lavQNVCyKzr9Us2kVgjfNAav2R0X+leWcj9q4XAXbF3hqEgo3
      g3HZE29hVIu5Ag0EWExXjAEQAMfkzgduorcqcuNetU5xIbZM1tObZRdxnxk5zONI
      YvmtacQcgj66TIWMjafU0HKjlCNdmzd3zZGSbsy8txyb+ilsiyWO81BalhK/HSzx
      2NLtnPcwjOZLuo4J6en3KuauwyeINbKui4+AvJ/1KdKSJXniS02mkk/46PN0WqPD
      lPKMs1bhjoZI4XpuYovH4RMUFEEpB0ccxf5C9vQeebmwYjy/BI+Ce5XZ9y+l4ABS
      YwDtCOEuEYYWtx1slQgTupWmIsEETZ+vmEWlQNL80FQ9Anp61WF1FkIi0s7DIvNy
      4Z5NUF7kvQe14FMUkpBWpVsnGwPVMvssDiA5gNladhquUxnidhJRuUIAqk4rbMre
      3hNAMO/hxvhcaF42RNhgQFpbr5gbZMYd0lXBpYpowaJG7F2GNV9drb4mdPsDYTzZ
      aujw/55iLAFUJZbcQTU4Qoi2fA+JQViYzSIxEqH7NHIbQ6jagBQWfk6cIgNxIVSv
      QeYoJQMfAcs4G0JEpk8EbQnbzejRnWUZQadnRs/TpAVQjBkrPEjEIL/mWTDe/kDd
      2DB1+wuBzXSFdq6MbrHLWLXLpKa+wrwLjx60zfkSWD0fmRKoUtQ9ALGByStdOlsA
      GquS2Pkp1KT/w3KwsITjO24LfoviOScBc1pC6XEg8fXCPw2qV74BKXnDh1XObviZ
      MbDfABEBAAGJAh8EGAEIAAkFAlhMV4wCGwwACgkQkmbE+hH9AP0jAxAAjW0VZ1AW
      WoRjR0EMtMXaUBiVVeLdXPmNpZz34/+XIT9M5ZquXJJHLickR7o6GK0EjvWaFB38
      vibFA4fbvkohxcavtIekz9rLdu3Kkolzabz2PPQ4i51Vns3PkmmZo/GhuA8ERChH
      EQDvi2T/zkbutmUdcdxg+3cuPpAMdtCr+6eyqU3Sn8NuAWChGixcdIVR3YT4tG0O
      uO9KlQtHlxW8jRujW0KNnTOItqKtw77biVsSstJREDbU716Cws2OvOJxqJUkv01K
      OwIVBNcC3Kvl2DLWesBrB9TqpotjrdemURfToywsIDtou7BMDUy27i14QzoroUbU
      Ir/byN0MYAJiZ7tbJUetNkHd3FeOHrrBCNthR4yY7hAvnGwAkkQKKZl2FA9VYGKs
      3c7MIoTk6yp94ZCmDIT7Tg4nlM+Hj8wh2s17sPchtAWOzScGn2LBG6mUXeZkD8b3
      N+3+73npcDP/pQ5SVdj1uX84yTTRLN1bW7EbY8diGyj9rQA5ZCFXE6tSjjsZLQST
      LCgATQJ4ks2l7XWcqOd/Jqa8+80jbEOHF1TqufhqAUpkWNMxp3R4KrI5NfZsLFt/
      iyLBrhSt0aV2/siwf3OqQRyyL6UC3ri+2kb2+A7Ck7wFQ7l3GXcRRltdHb4pDw8W
      zf8Uvc+eXJcX0YujN/hApyGYMXLobHpNCOW5Ag0EWExmJQEQANXt6VURsCHwYLxw
      2Q2LejJOd7LwU8pMfaf5si+ctWSOIrWhdKGamwx7JzS2WWE8wCNHBqCBCXlyNSaf
      wDi9Z1cyDcVDeE81320N1CYboJ1al2DZwiCa3MmG0QkHbpnwTRrQFwLfC+yjr/DB
      WNFy0UdwbJ7urelZW7knZVxqeF/srUx9gWRZqGxCvUyXSWCPRGtk5wkpmYKRKcuA
      zEoT2iafjii0SO2uD9Thtf2Kvc/wBqkus6tWpVL13RKgBM2+xfK7mmRzEBaAbFOu
      qOm7UJUnc5Ka+4kcPkQDWqtWVbAijKou5Vce7QFxl6qlS2K6LFVOqoA22FE7JwRu
      tXyg6/lqMPUERLTdVZ2x+6lv8A4GHoPlPZ0uFLv7fq7gFLL4Eisapk4RPL+WnKrj
      8pXHIGR35oy2EzsiBl+A7SgkQ5Gr9YvQ8qb5bQ8wXGx4wGbvviQjhctIO2lKQwQw
      Kh59o7OtwxJo0Qh5YTo/NvxY8oTrrZRXNwsC45S0QAjFY98b2/qac0Usu/9MEUM2
      o3WTzTo0c76pxef0FuNHvaPLnR6Zv5hfv+cCpmcMca3wNi14L3eItpgrDKzvEUEY
      kjP72lU9lHgEUr+TwQTlAscIFnEfdIw1rchqbXLP9QsjGy6M1C9hFmOLjxd4TzMd
      f41opO1npS/slok06YVKkHaMx3eHABEBAAGJBD4EGAEIAAkFAlhMZiUCGwICKQkQ
      kmbE+hH9AP3BXSAEGQEIAAYFAlhMZiUACgkQV8sKEhuuyy7Kow//ZO93gcLmxkpX
      S3JNhwBhsyLXSkBO1PRAURm7WoQBSudf9TDN0edaDx4SxRHY+oK4H5CaNkmUfqDm
      iubcEfVpfZI6V8InoFaUYnhkbw6g8BUoSiRCizWO8ns87vtyL3i/6BcbGTqH3O4n
      vwjqoIEqZboaaxWK1o1HOr/H7q2PSoh57Yyt6vkTMmHj7AFWZSRK5YDnon0OxcCz
      2n54PaV63LHyny+hZEhuk7YBuy7g9Dk/wUAb5QxfpiaZuMt/UaMC//sd5INJsx4z
      L1FmlNd3FLQ5RV5qXYKJVB7urYeO+wS+H9vMvgYcuje9eFqdX7T30OX+93/urman
      hFSvCiSpZkDOQU/rDsRblT7xiNTIHfpPNgln94t2fX3+A0X7cVflUN3IZb4vhLxv
      uPncIn+h7th5gi96RrP65fXwZV3KVq2cZeXAcdqxvruqf8VbGrEypO3rxbv0OC1o
      SzRDWAry+rwG9aO9sUzB0BGJTY7V9ByQwPEK0p+8QWLHHS56fwFon/LBlnOjsfFt
      SZXYXzgQJUExTOwvrqQju0X7zwcvJvz+2qn30m1/i0VXmrh0sy4u9uL5WMIYivj1
      DqRiqt3stlH7UlUXNATRB8TWpdZghg88poM5t+tp5bbNKckIEDfe2oZbLalnlmEX
      c1Gv0EqlgC9V92LZRMS2P/cXztEM+Ut4Iw//VImJAzrr8E9nRC0jlHm2op5GpyjD
      1UOQ0fuknguE+V6co950UZyfUvS7qejNpsIxelIE+xfiNwrjS64AtQ9YynjW+DSk
      oT4A6h6GrZpu7HqIJhbebn61jwTjSduq/HsCmuc3wyeB+xdPlbKuwSuBr08+e8j5
      KVbDH0zAvBddlNDKxyDx0ovNb0gtnDOTeYPWYVc0RCaqJcRKRW3PWs+sPh/JRxGR
      zXW/J8wwewct0d+z8Dx4E1uinvDf6u0m+HZJc6t5UDDv7+bYsHWq9AZ+lhRLr0kU
      auUn59g0l0w3r0XlmqNrBGCRqTyJldO2aU2abWOCpq9s+9pZNSPMkU10VsHbTUfU
      tEMTftXCQ6qw3LtC94Qo/RVakA49AJW4QkZmxDzu8gLcsfEW5OybeDxD9qNQGq7k
      xZGdIZmiEt9XvYyuBIG8HxSCnSezj6z1MaHbVBA4hy+eo7hwU3ursmDeAAepeo8e
      H9zyVtL/DNVI7t0UFBaxM2IetOC3jChEuISg7RHqtzKoNll7gIV7eCRSQ1yDygag
      X/iYQYonQzk46yGL7z+1lyGlTzurBVtUK22yb/kJoJhFBYMHS1XuKYKlKXo8IMVn
      bFd7ekQ9u6yR9krd1C36TzlyCUUpk2Ppa0O0ZpOATJEh+jS1eu5orBO/tK5qmheV
      Smt7/K/SeplXzSY=
      =6PwY
      -----END PGP PUBLIC KEY BLOCK-----

targets:
  lxc:
    create-message: |
      You just created an {{ image.description }} container.

    config:
      - type: all
        before: 5
        content: |-
          lxc.include = LXC_TEMPLATE_CONFIG/funtoo.common.conf

      - type: user
        before: 5
        content: |-
          lxc.include = LXC_TEMPLATE_CONFIG/funtoo.userns.conf

      - type: all
        after: 4
        content: |-
          lxc.include = LXC_TEMPLATE_CONFIG/common.conf

      - type: user
        after: 4
        content: |-
          lxc.include = LXC_TEMPLATE_CONFIG/userns.conf

      - type: all
        content: |-
          lxc.arch = {{ image.architecture_kernel }}

files:
 - name: hostname
   path: /etc/hostname
   generator: hostname

 - name: hosts
   path: /etc/hosts
   generator: hosts

packages:
  manager: egoportage
  update: false
  cleanup: true

actions:
  - trigger: post-packages
    action: |-
      #! /bin/sh
      set -eux

      rm -rf /boot/*
      rm -rf /usr/src/*
      rm -rf /var/git/meta-repo
      rm -rf /var/cache/portage

      cd /etc/init.d
      ln -s netif.tmpl net.eth0
      rc-update add net.eth0 default
      echo template=dhcpcd > /etc/conf.d/net.eth0

mappings:
  architecture_map: funtoo
